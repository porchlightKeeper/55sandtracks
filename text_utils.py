import random
from typing import List
from flask import render_template_string, url_for
import markdown

from storage import text_to_subject

NORMAL_FONT = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?"
FONTS = [
    "ğ”ğ”Ÿğ” ğ”¡ğ”¢ğ”£ğ”¤ğ”¥ğ”¦ğ”§ğ”¨ğ”©ğ”ªğ”«ğ”¬ğ”­ğ”®ğ”¯ğ”°ğ”±ğ”²ğ”³ğ”´ğ”µğ”¶ğ”·ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "ğ–†ğ–‡ğ–ˆğ–‰ğ–Šğ–‹ğ–Œğ–ğ–ğ–ğ–ğ–‘ğ–’ğ–“ğ–”ğ–•ğ––ğ–—ğ–˜ğ–™ğ–šğ–›ğ–œğ–ğ–ğ–Ÿğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "êêŒƒê‰“ê€¸êŸê‡ê…êƒ…ê€¤ê€­ê€˜ê’’ê‚µêˆ¤ê‚¦ê‰£ê†°ê‹ªêŒ—ê“„ê€êƒ´ê…êŠ¼êŒ©ê´êêŒƒê‰“ê€¸êŸê‡ê…êƒ…ê€¤ê€­ê€˜ê’’ê‚µêˆ¤ê‚¦ê‰£ê†°ê‹ªêŒ—ê“„ê€êƒ´ê…êŠ¼êŒ©ê´`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "ÉqÉ”pÇÉŸÉ“É¥Ä±É¾ÊlÉ¯uodbÉ¹sÊ‡nÊŒÊxÊzâˆ€á™ Æ†á—¡Æâ„²â…HIÅ¿â‹ŠË¥WNOÔ€ÎŒá´šSâŠ¥âˆ©Î›MXâ…„Z Ì–â‡‚á„…Æã„£Ş9ã„¥860-=][\Ø›,'Ë™/~Â¡@#$% Ì®â…‹*)(Â¯+}{|:â€><Â¿",
    "à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸĞºÉ­à¹“à¸ à¹×§á»£Ğ³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸĞºÉ­à¹“à¸ à¹×§á»£Ğ³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "ÇŸÉ®ÆˆÉ–É›Ê„É¢É¦É¨ÊÓ„ÊŸÊÕ¼Ö…Ö„Õ¦Ê€Ö†È¶ÊŠÊ‹Õ¡Ó¼ÊÊÇŸÉ®ÆˆÉ–É›Ê„É¢É¦É¨ÊÓ„ÊŸÊÕ¼Ö…Ö„Õ¦Ê€Ö†È¶ÊŠÊ‹Õ¡Ó¼ÊÊ`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "á—á°áˆá´á‹á¦á¶á‚á¥á á¦áá·áá§á®á¤á’á•á–á¬á‰á‡áŒ€á©ášá—á°áˆá´á‹á¦á¶á‚á¥á á¦áá·áá§á®á¤á’á•á–á¬á‰á‡áŒ€á©áš`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "Ä…áƒªÆˆÉ–É›Ê„É É§Ä±ÊÆ™Æ–É±Å‹Æ¡â„˜Õ¦à½Ê‚É¬Å³Û·á¿³Ò³áƒ§Ê‘Ä…áƒªÆˆÉ–É›Ê„É É§Ä±ÊÆ™Æ–É±Å‹Æ¡â„˜Õ¦à½Ê‚É¬Å³Û·á¿³Ò³áƒ§Ê‘`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "à¸„à¹–Â¢à»“Ä“fàº‡hià¸§klà¹“àº–à»pà¹‘rÅtà¸™à¸‡àºŸxà¸¯àºŠà¸„à¹–Â¢à»“Ä“fàº‡hià¸§klà¹“àº–à»pà¹‘rÅtà¸™à¸‡àºŸxà¸¯àºŠ`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "Î›Bá„ƒDÎ£FGÎ‰IJKá„‚MĞŸÓ¨PQĞ¯Æ§Æ¬Ğ¦VĞ©XYZÎ›Bá„ƒDÎ£FGÎ‰IJKá„‚MĞŸÓ¨PQĞ¯Æ§Æ¬Ğ¦VĞ©XYZ`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "Î±Ğ²Â¢âˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Î·ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒzÎ±Ğ²Â¢âˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Î·ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡Ñƒz`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "Ã¥ÃŸÂ¢ÃÃªÂ£ghÃ¯jklmÃ±Ã°Ã¾qrÂ§â€ ÂµvwxÂ¥zÃ„ÃŸÃ‡ÃÃˆÂ£GHÃŒJKLMÃ±Ã–Ã¾QRÂ§â€ ÃšVWÃ—Â¥Z`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "Ä…ÒÃ§ÕªÒ½Æ’ÖÕ°Ã¬ÊÒŸÓ€ÊÕ²Ö…Ö„Õ¦É¾Ê‚Õ§Õ´ÑµÕ¡Ã—Õ¾Õ€ÈºÎ²â†»á ÆÆ‘Æ“Ç¶Ä¯Ù„Ò êˆâ±®á à¶§Ï†Ò¨à½ ÏšÍ²Ô±á»¼à°šáƒ¯Ó‹É€`ğŸ™Ï©Ó à¥«Æ¼Ï¬7ğŸ à¥¯âŠ˜-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
    "á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘Oá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘Oá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”`1234567890-=[]\\;',./~!@#$%^&*()_+{}|:\"<>?",
]


def cool_font(text: str) -> str:
    font = random.choice(NORMAL_FONT)
    for i in range(len(NORMAL_FONT)):
        text = text.replace(NORMAL_FONT[i], font[i])
    return text


def render_markdown(text: str):
    html_content = markdown.markdown(text)
    return render_template_string('{{ content|safe }}', content=html_content)


def link_subjects_in_text(text: str, subjects: List[str]):
    """
    Replace occurrences of subject names in the provided text with hyperlinks to their respective paths.

    :param text: The text in which subject names are to be replaced with hyperlinks.
    :param subjects: A list of subject names.
    :return: The modified text with subject names replaced with hyperlinks.
    """
    for subject in subjects:
        safe_subject = text_to_subject(text)
        url = url_for(safe_subject)
        text = text.replace(subject, f"[{subject}]({url})")
    return text
